<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GeoInvest - Londublis</title>
    <link rel="stylesheet" href="./css/styles.css" />
    <link rel="stylesheet" href="./css/auth.css" />
    <link rel="stylesheet" href="./css/sugestoes-search.css" />

    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

    <!-- Carregar o CSS do Maplibre GL -->
    <link
      href="https://unpkg.com/maplibre-gl@2.3.0/dist/maplibre-gl.css"
      rel="stylesheet"
    />

    <!-- Carregar o JavaScript do Maplibre GL com defer para carregar depois -->
    <script src="https://unpkg.com/maplibre-gl@2.3.0/dist/maplibre-gl.js"></script>

    <script src="./shared/shared.js"></script>
  </head>
  <body>
    <!-- Header -->
    <div id="header-container"></div>

    <!-- Main Content -->
    <main class="main">
      <div class="container">
        <!-- Search Section -->
        <div class="search-info" id="searchInfo"></div>
        <section class="search-section">
          <div class="search-header">
            <h2>Descubra sua regi√£o</h2>
            <p>
              Pesquise por endere√ßos, coordenadas ou c√≥digos postais e explore
              os pontos de interesse e dados detalhados da regi√£o.
            </p>
          </div>

          <form class="search-form" id="searchForm">
            <div class="search-input-container">
              <svg
                class="search-icon"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
                <circle cx="12" cy="10" r="3" />
              </svg>
              <input
                type="text"
                id="searchInput"
                placeholder="Digite um endere√ßo, coordenadas ou c√≥digo postal..."
                class="search-input"
              />
              <button type="submit" class="search-button" id="searchButton">
                <svg
                  class="search-btn-icon"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="11" cy="11" r="8" />
                  <path d="m21 21-4.35-4.35" />
                </svg>
              </button>
            </div>
          </form>

          <!-- Lista de sugest√µes de pesquisa -->
          <ul id="suggestionsList" style="display: none"></ul>
        </section>

        <!-- Loading State -->
        <div class="loading" id="loading" style="display: none">
          <div class="loading-content">
            <div class="spinner"></div>
            <span>Carregando dados da regi√£o...</span>
          </div>
        </div>

        <!-- Welcome State -->
        <div class="welcome" id="welcome">
          <div class="welcome-content">
            <div class="welcome-icon">
              <svg
                width="48"
                height="48"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
                <circle cx="12" cy="10" r="3" />
              </svg>
            </div>
            <h3>Comece sua explora√ß√£o</h3>
            <p>
              Digite um endere√ßo ou localiza√ß√£o no campo de busca acima para
              descobrir os pontos de interesse e dados da regi√£o.
            </p>
          </div>
        </div>

        <!-- Results Content -->
        <div class="results" id="results" style="display: none">
          <!-- Action Buttons -->
          <div class="action-buttons">
            <button class="btn btn-primary" id="generateReport">
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <polyline points="7,10 12,15 17,10" />
                <line x1="12" y1="15" x2="12" y2="3" />
              </svg>
              Gerar Relat√≥rio PDF
            </button>

            <button class="btn btn-secondary" id="themeToggle">
              <svg
                class="theme-icon"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
              </svg>
              <span class="theme-text">Tema Escuro</span>
            </button>

            <div class="poi-counter">
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                />
                <polyline points="14,2 14,8 20,8" />
                <line x1="16" y1="13" x2="8" y2="13" />
                <line x1="16" y1="17" x2="8" y2="17" />
                <polyline points="10,9 9,9 8,9" />
              </svg>
              <span id="poiCount">0 POIs encontrados</span>
            </div>
          </div>

          <!-- Map and POI List -->
          <div class="content-grid">
            <div class="map-section">
              <div class="section-header">
                <h3>Mapa Interativo</h3>
                <p>
                  Clique nos √≠cones para ver detalhes dos pontos de interesse
                </p>
              </div>
              <div class="map-container" id="mapContainer">
                <!-- Map will be generated here -->
              </div>
            </div>

            <div class="sidebar">
              <div class="poi-list" id="poiList">
                <!-- POI list will be generated here -->
              </div>
            </div>
          </div>

          <!-- Region Stats -->
          <div class="region-stats" id="regionStats">
            <!-- Region stats will be generated here -->
          </div>

          <!-- Selected POI Details -->
          <div class="selected-poi" id="selectedPoi" style="display: none">
            <!-- Selected POI details will be shown here -->
          </div>
        </div>
      </div>
    </main>

    <!-- Chatbot -->
    <div class="chatbot-container" id="chatbotContainer">
      <!-- Chatbot Toggle Button -->
      <button class="chatbot-toggle" id="chatbotToggle">
        <span class="toggle-icon">
          <svg
            fill="#ffffff"
            width="30px"
            height="30px"
            viewBox="0 0 32 32"
            id="icon"
            xmlns="http://www.w3.org/2000/svg"
          >
            <defs>
              <style>
                .cls-1 {
                  fill: none;
                }
              </style>
            </defs>
            <title>chat-bot</title>
            <path
              d="M16,19a6.9908,6.9908,0,0,1-5.833-3.1287l1.666-1.1074a5.0007,5.0007,0,0,0,8.334,0l1.666,1.1074A6.9908,6.9908,0,0,1,16,19Z"
            />
            <path d="M20,8a2,2,0,1,0,2,2A1.9806,1.9806,0,0,0,20,8Z" />
            <path d="M12,8a2,2,0,1,0,2,2A1.9806,1.9806,0,0,0,12,8Z" />
            <path
              d="M17.7358,30,16,29l4-7h6a1.9966,1.9966,0,0,0,2-2V6a1.9966,1.9966,0,0,0-2-2H6A1.9966,1.9966,0,0,0,4,6V20a1.9966,1.9966,0,0,0,2,2h9v2H6a3.9993,3.9993,0,0,1-4-4V6A3.9988,3.9988,0,0,1,6,2H26a3.9988,3.9988,0,0,1,4,4V20a3.9993,3.9993,0,0,1-4,4H21.1646Z"
            />
            <rect
              id="_Transparent_Rectangle_"
              data-name="&lt;Transparent Rectangle&gt;"
              class="cls-1"
              width="32"
              height="32"
            />
          </svg>
        </span>
        <div class="notification-badge" id="notificationBadge">1</div>
      </button>

      <!-- Chatbot Window -->
      <div class="chatbot-window" id="chatbotWindow">
        <div class="chatbot-header">
          <div class="chatbot-avatar">
            <svg
              fill="#ffffff"
              width="30px"
              height="30px"
              viewBox="0 0 24 24"
              version="1.1"
              xmlns="http://www.w3.org/2000/svg"
              xmlns:xlink="http://www.w3.org/1999/xlink"
            >
              <title>ic_fluent_bot_24_regular</title>
              <desc>Created with Sketch.</desc>
              <g
                id="üîç-Product-Icons"
                stroke="none"
                stroke-width="1"
                fill="none"
                fill-rule="evenodd"
              >
                <g
                  id="ic_fluent_bot_24_regular"
                  fill="#ffffff"
                  fill-rule="nonzero"
                >
                  <path
                    d="M17.7530511,13.999921 C18.9956918,13.999921 20.0030511,15.0072804 20.0030511,16.249921 L20.0030511,17.1550008 C20.0030511,18.2486786 19.5255957,19.2878579 18.6957793,20.0002733 C17.1303315,21.344244 14.8899962,22.0010712 12,22.0010712 C9.11050247,22.0010712 6.87168436,21.3444691 5.30881727,20.0007885 C4.48019625,19.2883988 4.00354153,18.2500002 4.00354153,17.1572408 L4.00354153,16.249921 C4.00354153,15.0072804 5.01090084,13.999921 6.25354153,13.999921 L17.7530511,13.999921 Z M17.7530511,15.499921 L6.25354153,15.499921 C5.83932796,15.499921 5.50354153,15.8357075 5.50354153,16.249921 L5.50354153,17.1572408 C5.50354153,17.8128951 5.78953221,18.4359296 6.28670709,18.8633654 C7.5447918,19.9450082 9.44080155,20.5010712 12,20.5010712 C14.5599799,20.5010712 16.4578003,19.9446634 17.7186879,18.8621641 C18.2165778,18.4347149 18.5030511,17.8112072 18.5030511,17.1550005 L18.5030511,16.249921 C18.5030511,15.8357075 18.1672647,15.499921 17.7530511,15.499921 Z M11.8985607,2.00734093 L12.0003312,2.00049432 C12.380027,2.00049432 12.6938222,2.2826482 12.7434846,2.64872376 L12.7503312,2.75049432 L12.7495415,3.49949432 L16.25,3.5 C17.4926407,3.5 18.5,4.50735931 18.5,5.75 L18.5,10.254591 C18.5,11.4972317 17.4926407,12.504591 16.25,12.504591 L7.75,12.504591 C6.50735931,12.504591 5.5,11.4972317 5.5,10.254591 L5.5,5.75 C5.5,4.50735931 6.50735931,3.5 7.75,3.5 L11.2495415,3.49949432 L11.2503312,2.75049432 C11.2503312,2.37079855 11.5324851,2.05700336 11.8985607,2.00734093 L12.0003312,2.00049432 L11.8985607,2.00734093 Z M16.25,5 L7.75,5 C7.33578644,5 7,5.33578644 7,5.75 L7,10.254591 C7,10.6688046 7.33578644,11.004591 7.75,11.004591 L16.25,11.004591 C16.6642136,11.004591 17,10.6688046 17,10.254591 L17,5.75 C17,5.33578644 16.6642136,5 16.25,5 Z M9.74928905,6.5 C10.4392523,6.5 10.9985781,7.05932576 10.9985781,7.74928905 C10.9985781,8.43925235 10.4392523,8.99857811 9.74928905,8.99857811 C9.05932576,8.99857811 8.5,8.43925235 8.5,7.74928905 C8.5,7.05932576 9.05932576,6.5 9.74928905,6.5 Z M14.2420255,6.5 C14.9319888,6.5 15.4913145,7.05932576 15.4913145,7.74928905 C15.4913145,8.43925235 14.9319888,8.99857811 14.2420255,8.99857811 C13.5520622,8.99857811 12.9927364,8.43925235 12.9927364,7.74928905 C12.9927364,7.05932576 13.5520622,6.5 14.2420255,6.5 Z"
                    id="üé®-Color"
                  ></path>
                </g>
              </g>
            </svg>
          </div>
          <div class="chatbot-info">
            <h3>Assistente</h3>
            <span class="status online">Online</span>
          </div>
          <button class="chatbot-close" id="chatbotClose">√ó</button>
        </div>

        <div class="chatbot-messages" id="chatbotMessages">
          <div class="message bot-message">
            <div class="message-avatar">
              <svg
                fill="#ffffff"
                width="30px"
                height="30px"
                viewBox="0 0 24 24"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
              >
                <!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
                <title>ic_fluent_bot_24_regular</title>
                <desc>Created with Sketch.</desc>
                <g
                  id="üîç-Product-Icons"
                  stroke="none"
                  stroke-width="1"
                  fill="none"
                  fill-rule="evenodd"
                >
                  <g
                    id="ic_fluent_bot_24_regular"
                    fill="#212121"
                    fill-rule="nonzero"
                  >
                    <path
                      d="M17.7530511,13.999921 C18.9956918,13.999921 20.0030511,15.0072804 20.0030511,16.249921 L20.0030511,17.1550008 C20.0030511,18.2486786 19.5255957,19.2878579 18.6957793,20.0002733 C17.1303315,21.344244 14.8899962,22.0010712 12,22.0010712 C9.11050247,22.0010712 6.87168436,21.3444691 5.30881727,20.0007885 C4.48019625,19.2883988 4.00354153,18.2500002 4.00354153,17.1572408 L4.00354153,16.249921 C4.00354153,15.0072804 5.01090084,13.999921 6.25354153,13.999921 L17.7530511,13.999921 Z M17.7530511,15.499921 L6.25354153,15.499921 C5.83932796,15.499921 5.50354153,15.8357075 5.50354153,16.249921 L5.50354153,17.1572408 C5.50354153,17.8128951 5.78953221,18.4359296 6.28670709,18.8633654 C7.5447918,19.9450082 9.44080155,20.5010712 12,20.5010712 C14.5599799,20.5010712 16.4578003,19.9446634 17.7186879,18.8621641 C18.2165778,18.4347149 18.5030511,17.8112072 18.5030511,17.1550005 L18.5030511,16.249921 C18.5030511,15.8357075 18.1672647,15.499921 17.7530511,15.499921 Z M11.8985607,2.00734093 L12.0003312,2.00049432 C12.380027,2.00049432 12.6938222,2.2826482 12.7434846,2.64872376 L12.7503312,2.75049432 L12.7495415,3.49949432 L16.25,3.5 C17.4926407,3.5 18.5,4.50735931 18.5,5.75 L18.5,10.254591 C18.5,11.4972317 17.4926407,12.504591 16.25,12.504591 L7.75,12.504591 C6.50735931,12.504591 5.5,11.4972317 5.5,10.254591 L5.5,5.75 C5.5,4.50735931 6.50735931,3.5 7.75,3.5 L11.2495415,3.49949432 L11.2503312,2.75049432 C11.2503312,2.37079855 11.5324851,2.05700336 11.8985607,2.00734093 L12.0003312,2.00049432 L11.8985607,2.00734093 Z M16.25,5 L7.75,5 C7.33578644,5 7,5.33578644 7,5.75 L7,10.254591 C7,10.6688046 7.33578644,11.004591 7.75,11.004591 L16.25,11.004591 C16.6642136,11.004591 17,10.6688046 17,10.254591 L17,5.75 C17,5.33578644 16.6642136,5 16.25,5 Z M9.74928905,6.5 C10.4392523,6.5 10.9985781,7.05932576 10.9985781,7.74928905 C10.9985781,8.43925235 10.4392523,8.99857811 9.74928905,8.99857811 C9.05932576,8.99857811 8.5,8.43925235 8.5,7.74928905 C8.5,7.05932576 9.05932576,6.5 9.74928905,6.5 Z M14.2420255,6.5 C14.9319888,6.5 15.4913145,7.05932576 15.4913145,7.74928905 C15.4913145,8.43925235 14.9319888,8.99857811 14.2420255,8.99857811 C13.5520622,8.99857811 12.9927364,8.43925235 12.9927364,7.74928905 C12.9927364,7.05932576 13.5520622,6.5 14.2420255,6.5 Z"
                      id="üé®-Color"
                    ></path>
                  </g>
                </g>
              </svg>
            </div>
            <div class="message-content">
              <p>Ol√°! Como posso ajudar-te hoje? üòä</p>
              <p>
                Estou aqui para responder a d√∫vidas sobre im√≥veis e pontos de
                interesse.
              </p>
              <div class="message-time">agora</div>
            </div>
          </div>
        </div>

        <div class="typing-indicator" id="typingIndicator">
          <div class="typing-avatar">ü§ñ</div>
          <div class="typing-dots">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>

        <div class="quick-actions" id="quickActions">
          <button class="quick-action" data-action="search">
            üîç Pesquisar Im√≥veis
          </button>
          <button class="quick-action" data-action="pois">
            üìç Pontos de Interesse
          </button>
          <button class="quick-action" data-action="pdf">
            üìÑ Relat√≥rios PDF
          </button>
          <button class="quick-action" data-action="help">‚ùì Ajuda</button>
        </div>

        <div class="chatbot-input-container">
          <div class="chatbot-input">
            <input
              type="text"
              id="messageInput"
              placeholder="Digite a sua mensagem..."
            />
            <button id="sendButton" class="send-button">
              <span class="send-icon">‚û§</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div id="footer-container"></div>

    <!-- Incluindo a biblioteca do Protomaps -->
    <script src="https://unpkg.com/maplibre-gl@2.1.7/dist/maplibre-gl.js"></script>

    <script src="map.js"></script>
    <script type="module" src="script.js"></script>

    <script src="./js/counter.js"></script>
    <script src="./js/chatbot/chatbot-data.js"></script>
    <script src="./js/chatbot/chatbot-responses.js"></script>
    <script src="./js/chatbot/chatbot-ui.js"></script>
    <script src="./js/chatbot/chatbot-main.js"></script>
    <script src="./js/auth.js" defer></script>

    <script src="js/updateHeader.js"></script>

    <script src="dashboard.js"></script>
  </body>
</html>
